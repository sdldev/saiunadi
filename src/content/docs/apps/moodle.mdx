---
title: moodle
description: Setting server moodle
---

# Setting LMS MOODLE

```
apt update && apt upgrade -y
```
### NGINX
```
apt-get install -y htop git curl wget unzip zip nginx
```
#### NGINX Configure

```
sudo nano /etc/nginx/nginx.conf

```

keepalive_timeout 2;


```
sudo nano /etc/nginx/sites-available/moodle
```

```
server {
listen 80;
listen [::]:80;
root /var/www/html/moodle;
index index.php index.html index.htm;
server_name lms.sdldev.my.id;

location / {
try_files $uri $uri/ =404;
}

client_max_body_size 8M;

location /dataroot/ {
internal;
alias /var/moodledata/;
}

location ~ [^/]\.php(/|$) {
    fastcgi_split_path_info  ^(.+\.php)(/.+)$;
    fastcgi_index            index.php;
    fastcgi_pass unix:/var/run/php/php7.4-fpm.sock;
    include                  fastcgi_params;
    fastcgi_param   PATH_INFO       $fastcgi_path_info;
    fastcgi_param   SCRIPT_FILENAME $document_root$fastcgi_script_name;
}   

location ~* \.(ico|pdf|flv)$ {

        expires 28d;
        
    }   
    
location ~* \.(js|css|png|jpg|jpeg|gif|swf|xml|txt)$ {

        expires 7d;
}
}
```

```
sudo ln -s /etc/nginx/sites-available/moodle /etc/nginx/sites-enabled/
systemctl enable nginx
systemctl start nginx
systemctl reload nginx


```

### MARIA DB
```
apt install -y mariadb-server mariadb-client
```

```
mysql_secure_installation
```

```
mysql
show databases;
CREATE DATABASE moodle;
CREATE USER 'moodle'@'localhost' IDENTIFIED BY 'SCRpswwd2023**';
GRANT ALL ON moodle.* TO 'moodle'@'localhost' IDENTIFIED BY 'SCRpswwd2023**'WITH GRANT OPTION;
FLUSH PRIVILEGES;
exit
```

### PHP

```
sudo apt install -y curl wget gnupg2 ca-certificates lsb-release apt-transport-https
wget https://packages.sury.org/php/apt.gpg
sudo apt-key add apt.gpg
echo "deb https://packages.sury.org/php/ $(lsb_release -sc) main" | sudo tee /etc/apt/sources.list.d/php7.list
sudo apt install -y php7.4 php7.4-cli php7.4-common


```

```
sudo apt install php7.4-mysql php7.4-gmp php7.4-fpm php7.4-curl php7.4-intl php7.4-mbstring php7.4-soap php7.4-gd php7.4-zip php7.4-gd php7.4-xml php7.4-readline php7.4-opcache php7.4-json php7.4-cli php7.4-common php7.4-xmlrpc
```

#### OPTIMASI
sudo nano /etc/php/7.4/fpm/php.ini
file_uploads = On
allow_url_fopen = On
memory_limit = 300M
upload_max_filesize = 100M
max_execution_time = 360
post_max_size = 8M
cgi.fix_pathinfo=0
max_input_vars = 5000


cd  /var/www/html
sudo chmod -R 777 /var/www/html/moodle
sudo chown -R www-data /var/www/html/moodle

mkdir /var/www/html/moodledata
sudo chmod -R 777 /var/www/html/moodledata

chown -R www-data /var/www/html/moodledata
